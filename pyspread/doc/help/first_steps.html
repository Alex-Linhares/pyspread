<aside>
</aside>


<h1 class="title">First steps into pyspread</h1>
<br>


<h1>About this document</h1>


<p class="one_line_heading">
    This document provides a quick overview over pyspread.
    Readers should have at least some experience with Python.
</p>


<h1>What is pyspread?</h1>


<p class="one_line_heading">
    Pyspread is a spreadsheet application that computes Python
    expressions in its cells.
    It is written in the programming language Python.
</p>

<p class="one_line_heading">
    The core mission of pyspread is to be the most pythonic spreadsheet.
</p>

<p class="one_line_heading">
    Pyspread does not follow the traditional spreadsheet approach.
    Cell functions that are known from conventional spreadsheets
    such as Excel, gnumeric or OpenOffice.org Calc are not supported.
    Instead, Python expressions are entered into the spreadsheet
    cells. Each cell returns a Python object. These objects can
    represent anything including lists or matrices.
</p>

<p class="one_line_heading">
    Pyspread's approach is comparable to the spreadsheet Siag. 
    However, Siag uses the programming language Scheme.
</p>

<p class="one_line_heading">
    At least basic knowledge of Python is required to
    effectively use pyspread.
    Pyspread provides a three dimensional grid that can comprise
    millions of rows, columns and tables. This is possible because
    a dictionary is used for storing all grid data. Note that
    tables with many filled cells may require considerable
    amounts of RAM.
</p>


<h1>Basic concepts</h1>


<h2>3D grid</h2>

<p class="one_line_heading">
    Instead of work sheets that may be found in other 
    spreadsheets, pyspread features one 3D grid that has
    rows, columns and tables. This concept's benefit is
    that each dimension is accessed and handled equally.
    Note that in order to prevent data loss, adding or
    deleting rows only affects the current table.
</p>

<h2>Everything is accessible</h2>

<p class="one_line_heading">
    All parts of pyspread are written in Python. Therefore, all
    objects can be accessed from within each cell. This is also the
    case for external modules.
</p>

<p class="one_line_heading">
    There are 5 convenient
    "magical" objects, which are merely syntactic sugar: S, X,
    Y and Z and nn.
</p>

<p class="one_line_heading">
    S is the grid data object.
    It is ultimately based on a dict. However, it consists of
    several layers on top. When indexing or slicing, it
    behaves similarly to a 3D numpy-array that returns result
    objects. When calling it (like a function) with a 3 tuple,
    it returns the cell code.
</p>

<p class="one_line_heading">
    X, Y and Z represent the
    current cell coordinates. When copied to another cell,
    these coordinates change accordingly. This approach allows
    relative addressing by adding the relative coordinates to
    X, Y or Z. Therefore, no special relative addressing
    methods are needed.
</p>

<p class="one_line_heading">
    nn is a function that
    flattens a numpy array and removes all objects that are
    None. This function makes special casing None for
    operations such as sum unnecessary. nn is provided in
    pyspread &gt;v.0.3.0.
</p>

<p class="one_line_heading">
    External modules are
    accessible from each cell. Unfortunately, Python's
    convenient import syntax</p>
    <pre>
        from xx import yy
    </pre>
</p>

<p class="one_line_heading">
    is no expression. Therefore, the expression
    <pre>
        xx = __import__("xx")
    </pre>
</p>

<p class="one_line_heading">
    has to be used.
    Alternatively, the import statement can be used from
    within the macro editor.
</p>


<h2>Python code as cell language</h2>

<p class="one_line_heading">
    Pyspread uses Python expressions in each cell.
    This is similar to typing expressions into the Python shell.
    The main difference is that cells are only executed
    when required e.g. for displaying results. There is no
    guaranteed execution order.
</p>

<p class="one_line_heading">
    Cell results may be accessed va the S object. S[0,2,1]
    returns the result of the cell that is situated in the first row
    of the third column of the second table.
</p>

<p class="one_line_heading">
    Cell results may be assigned to a variable that is
    accessible from any cell. This assignment only
    works once per cell. Therefore,
    <pre>
        a = b = 2
    </pre>
</p>
<p class="one_line_heading">
    is <strong style="font-weight: bold;">invalid</strong>
    in a pyspread cell.
</p>

<h2>GPG based security</h2>

<p class="one_line_heading">
    Since Python expressions are
    evaluated in pyspread, a pyspread spreadsheet is as
    powerful as any program. Therefore, it could harm the
    system or even send confidential data to third persons
    over the Internet.
</p>

<p class="one_line_heading">
    Even though this is
    basically the case for all office applications, the easy
    access to such behavior makes precautions necessary. The
    idea in pyspread is that you - the user - are trustworthy
    and no-one else. If you save a file and if you have the
    Python gnupg interface installed then a signature is saved
    with it (suffix .pys.sig). Only you can re-open the file
    directly. If anyone else opens the file, it is displayed
    in safe mode, i.e. each cell displays the cell code and
    no cell code is evaluated. The user can approve the file.
    Afterwards, cell code is evaluated. When the user then
    saves the file, it is newly signed. Then it can be
    re-opened without safe mode.
</p>

<p class="one_line_heading">
    An intended side-effect of
    this approach is that when two users open the file on a
    network share, the signature file of one user is not
    recognized by the other, which makes re-approval
    necessary.
</p>

<p class="one_line_heading">
    Technically, signing is done
    with GPG. When starting pyspread the first time, no GPG key
    is present and saved files are not signed. In order to activate 
    signing, you can generate or choose an existing key via  
    File->Switch GPG key...
</p>


<h1>Current limitations</h1>


<p class="one_line_heading">
    External libraries that set states in several steps (e.g. rpy2)
    may be hard to use because in pyspread cell execution order is
    <b>not</b> guaranteed. Such libraries should be used from within
    a macro.
</p>

<p class="one_line_heading">
    There is no selection rectangle for auto-filling cells. Some
    of this functionality is provided by repeating cell content
    when pasting into selections.
</p>

<p class="one_line_heading">
    Execution of C code that is called from Python expressions
    cannot be interrupted or terminated if slow. C code means that
    creating very large integers cannot be interrupted while a for
    loop can. Since spreadsheet code is executed sequentially, such
    long running C code may block pyspread.
</p>

<p class="one_line_heading">
    Cyclic dependencies of cells stop at maximum recursion depth.
    If there are many cyclic dependencies, this may slow down 
    pyspread.
</p>

<p class="one_line_heading">
    Loading and saving Excel files is not feature complete.
    Data will be lost when saving a document
    as an xls file and loading it again.
</p>


<h1>Installation</h1>


<h2>Dependencies</h2>

<p class="one_line_heading">
    Pyspread works on Linux and other GTK platforms as well as on Windows.
    While there have been reports that pyspread can be used on OS X as well,
    OS X is currently unsupported.
    <br>
    Pyspread requires the following software to be installed:
</p>

<ul class="one_line_heading">
  <li> <a href="http://www.python.org/">Python</a>
    (&gt;=2.7, &lt;3.0) </li>
  <li> <a href="http://www.numpy.org/">numpy</a>
    (&gt;=1.1.0) </li>
  <li> <a href="http://www.wxpython.org/">wxPython</a>
    (&gt;=2.8.10.1, Unicode version required) </li>
  <li> <a href="http://matplotlib.org/">matplotlib</a>
    (&gt;=1.1.1)</li>
  <li> <a href="http://cairographics.org/pycairo/">pycairo</a>
    (&gt;=1.8.8)</li>
</ul>

<p class="one_line_heading">
  The following optional dependencies improve user experience:
</p>

<ul class="one_line_heading">
  <li> <a href="http://code.google.com/p/python-gnupg/">python-gnupg</a>
    (&gt;=0.3.0, for opening own files without approval) <br>
  </li>
  <li> <a href="http://www.python-excel.org/">xlrd</a>
    (&gt;=0.9.2, for loading Excel files)</li>
  <li><a href="http://www.python-excel.org/">xlwt</a>
    (&gt;=0.9.2, for saving Excel files)</li>
  <li><a href="http://jedi.jedidjah.ch">jedi</a>
    (&gt;=0.8.0, for tab completion and context help in the
    entry line)</li>
  <li> <a href="http://cairographics.org/pyrsvg/">pyrsvg</a>
    (&gt;=2.32, for displaying SVG files in cells)</li>
  <li><a href="http://matplotlib.org/basemap/">basemap</a>
    (&gt;=1.0.7, for the weather example pys file)<br>
  </li>
</ul>


<h2>Source</h2>

<p class="one_line_heading">

  These instructions are for installing the source tarball
  <br>
  <a href="https://pypi.python.org/packages/source/p/pyspread/pyspread-0.4.tar.gz#md5=6188e2c4c2ed9c58add7f26b70b7e05d">pyspread v0.4</a>
  (<a href="https://manns.github.io/pyspread/releases/pyspread-0.4.tar.gz.sig">gpg sig</a>).
  <br> <br>
  Installation:
  <br>
  <ol class="one_line_heading">
    <li>
      Ensure that <span style="text-decoration: underline;">all</span>
      dependencies are installed.
      <br> <br>
    </li>
    <li>
      Unpack the tarball
      <br> <br>
    </li>
    <li>
      cd to the extraction directory
      <br> <br>
    </li>
    <li>
      Type in
      <br>
      <tt>python setup.py install</tt>
    </li>
  </ol>
</p>


<h2>Linux</h2>

<p class="one_line_heading">

  The following distributions provide pyspread as a package
  (latest release linked):
  <br>

</p>

<table class="one_line_heading" style=" text-align: left;"
       border="0" cellpadding="4" cellspacing="7">
  <tbody>
    <tr>
      <td style="text-align: center;"><img style=" width:
          24px; height: 24px;" alt="Arch logo"
          src="http://manns.github.io/pyspread/images/arch-logo-small.png"
          align="middle"><br>
      </td>
      <td style="text-align: left;">Arch</td>
      <td><a
          href="https://aur.archlinux.org/packages/pyspread/">pyspread v0.3.2</a><br>
      </td>
    </tr>
    <tr>
      <td style="text-align: center;"><img style=" width:
          20px; height: 24px;" alt="Debian logo"
          src="http://manns.github.io/pyspread/images/debian-logo-small.png"
          align="middle"></td>
      <td style="text-align: left;">Debian</td>
      <td><a
          href="https://packages.debian.org/de/sid/pyspread">pyspread v0.3.3</a></td>
    </tr>
    <tr>
      <td style="text-align: center;"><img style=" width:
          23px; height: 24px;" alt="Mageia logo"
          src="http://manns.github.io/pyspread/images/mageia-logo-small.png"
          align="middle"></td>
      <td style=" text-align: left;">Mageia</td>
      <td><a href="http://rpm.pbone.net/index.php3/stat/4/idpl/27539765/dir/mageia_cauldron/com/pyspread-0.3.3-3.mga5.x86_64.rpm.html">pyspread v0.3.3</a></td>
    </tr>
    <tr>
      <td style="text-align: center;"><img style=" width:
          24px; height: 24px;" alt="Slackware logo"
          src="http://manns.github.io/pyspread/images/slackware-logo-small.png"><br>
      </td>
      <td style="text-align: left;">Slackware</td>
      <td><a
          href="http://slackbuilds.org/repository/14.1/office/pyspread/">pyspread v0.3.2</a></td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
          style=" width: 24px; height: 24px;" alt="Ubuntu
          logo" src="http://manns.github.io/pyspread/images/ubuntu-logo-small.png"
          align="middle"></td>
      <td style="vertical-align: top;">Ubuntu</td>
      <td style="vertical-align: top;"><a
          href="http://packages.ubuntu.com/de/vivid/pyspread">pyspread v0.3.3</a></td>
    </tr>
  </tbody>
</table>

<p class="one_line_heading">

  For these distributions, the easiest way is to install
  pyspread from the repositories. The source distribution can
  also be used e.g. if the packaged version is outdated.

</p>


<h2>Windows</h2>

<p class="one_line_heading">

  For Windows, please follow these instructions. In order to make Windows
  installation easier, links point to sites where both 32 bit and to 64 bit versions are provided.<br>
  <ol class="one_line_heading">
    <li>Download and install Python, numpy and matplotlib.
      You can find 32bit and 64bit packages of WinPython <a
        href="http://winpython.sourceforge.net/">here</a>.
      Make sure to get the Python2 version.
      If WinPython is used then the WinPython control panel is recommended for all installations.<br> <br>
    </li>
    <li>Download and install Cairo and pycairo. Working binaries are available <a
        href="http://www.lfd.uci.edu/%7Egohlke/pythonlibs/">here</a>. Note that Cairo has to be installed by maunually copying it. Make sure to read the installation instructions.<br>
      <br>
    </li>
    <li>Download and install <a
        href="http://www.wxpython.org/download.php#stable">wxPython 2.8.x</a>.<br>
      <br>
    </li>
    <li>Download and install gnupg (<a
        href="http://www.gpg4win.org/">Gpg4win</a> supports
      32&amp;64bit)<br>
      <br>
    </li>
    <li>Download and install <a
        href="http://pythonhosted.org/python-gnupg/#download">python-gnupg</a>.<br>
      <br>
      For&nbsp; <span style="font-weight: bold;">32 bit
        systems</span>, an exe installer
      (python-gnupg-0.3.4.win32.exe) is provided on the linked
      page.<br>
      <br>
      For <span style="font-weight: bold;">64 bit systems</span>,
      the python-gnupg tarball (python-gnupg-0.3.4.tar.gz) has
      to be extracted (e.g. with 7zip) and installed as
      follows:<br>
      <br>
    </li>
    <li>Download and install the source distribution of pyspread<br>
      <br>
    </li>
    <li>Start pyspread by double-clicking on the file
      pyspread.bat in the extraction directory</li>
  </ol>

</p>


<h1>The pyspread workplace</h1>


<h2>Starting and exiting pyspread</h2>

<p class="one_line_heading">
    On Linux or *nix systems, type
    <pre>
        $ pyspread
    </pre>
</p>
<p class="one_line_heading">
    from the command prompt. If you want to run pyspread without
    installation then cd into the pyspread directory and type
    <pre>
        $ pyspread.sh
    </pre>
</p>
<p class="one_line_heading">
    On Windows, type 
    <pre>
        &gt; pyspread.bat
    </pre>
</p>
<p class="one_line_heading">
    in the command line or launch the file via the Windows Explorer
    (click or double click)
</p>

<p class="one_line_heading">
    You can exit pyspread by closing the main window or by selecting
    File -&gt; Quit from the menu.
</p>


<h2>Pyspread main window</h2>

<p class="one_line_heading">
    The main window comprises the following components (see Figure):
</p>
<ul class="one_line_heading">
    <li>Title bar</li>
    <li>Menu</li>
    <li>Toolbars</li>
    <li>Entry line</li>
    <li>Insertion mode toggle button (enabled on *nix only)</li>
    <li>Table selector</li>
    <li>Grid</li>
    <li>Status bar</li>
</ul>

<p class="one_line_heading">
    <a href="images/screenshot_main_window.png">
        <img alt="Pyspread main window"
             src="images/screenshot_main_window_preview.png"
             style="border: 0px solid ; width: 200px; height: 154px;">
    </a>
</p>

<h2>Title bar</h2>

<p class="one_line_heading">
    When pyspread is started or a new spreadsheet is created then the
    title bar displays "pyspread". When a file is opened or saved
    then the filename is presented in front of " - pyspread".
</p>

<p class="one_line_heading">
    Whenever a spreadsheet is changed then  an askerisk "*" is
    displayed in front of the title bar text.
</p>


<h2>Main menu</h2>

<h3>File menu</h3>

<h4>New</h4>
<p class="one_line_heading">
    An empty spreadsheet can be created by File -&gt; New. <br>
    A Dialog pops up, in which
    the size of the new spreadsheet grid can be entered. Note
    that even though sizes of several million rows or columns
    are possible, there is a limit that is imposed by
    wx.Python. Therefore, grids with more than 80 million rows
    and 30 million columns may show problems and
    instabilities.
</p>
<p class="one_line_heading">
    <a href="images/screenshot_new_dialog.png">
        <img alt="Grid dimension dialog"
             src="images/screenshot_new_dialog_preview.png"
             style="border: 0px solid; border: 0px solid; width:
             200px; height: 141px;">
    </a>
</p>

<h4>Open</h4>
<p class="one_line_heading">
    Loading a spreadsheet from disk can be initiated with File
    -&gt; Open. Opening a file expects a file with the
    extension .pys. The file format is pyspread specific.<br>
</p>
<p class="one_line_heading">
    Starting from v0.3.0 there
    is a second file format with the extension .pysu. It is
    identical to pys but for the file being uncompressed. This
    format can be beneficial when using pyspread in
    combination with file version control systems such as git.<br>
</p>
<p class="one_line_heading">
    Excel xls files can also be opened via File -&gt; Open if the
    Python module xlrd is installed.
    Cell content and cell attributes are retrieved.
    However, functions and macros are neither loaded nor converted.
</p>

<p class="one_line_heading">
    Since pyspread files are
    ultimately Python programs, a file is opened in
    safe mode if
    <ul>
        <li>it has not been previously signed by the
            current user on the current system or</li>
        <li>gnupg is not installed or not configured to use a key
            with an empty(!) password.</li>
    </ul>
</p>
<p class="one_line_heading">
    Safe mode means that
    the cell content is loaded and displayed in the grid.
    However, it is not executed, so that 2+2 remains 2+2 and
    is not computed into 4. You can leave safe mode with File
    -&gt; Approve.
</p>


<h4>Save</h4>
<p class="one_line_heading">
    A spreadsheet can be stored to disk with File
    -&gt; Save.
    If a file is already opened, Save overwrites it directly.
    Otherwise, Save prompts for a filename.
</p>

<p class="one_line_heading">
    When a file is saved and the Python module gnupg is installed 
    (and configured with a key that has no password) then a
    signature is created in an additional file with the suffix
    .pys.sig. The signature is a PGP signature. When pyspread
    is started the first time for a user, a pgp key pair is
    crreated for the user pyspread_&lt;user-id&gt;. This key
    pair is used for signing pyspread save files. A correct
    signature file lets pyspread open a file without going
    into safe mode. Note that the save file is <span
    style="font-weight: bold;">not</span> encrypted in any
    way.
</p>
<p class="one_line_heading">
    The pys file format is a
    bzip2-ed Text file with the following structure (since
    version 0.2.0):
</p>

<p class="one_line_heading">
    <code>
      [Pyspread save file version]<br>
      0.1<br>
      [shape]<br>
      1000 100 3<br>
      [grid]<br>
      7 22 0 'Testcode1'<br>
      8 9 0 'Testcode2'<br>
      [attributes]<br>
      [] [] [] [] [(0, 0)]
        0 'textfont' u'URW Chancery L'<br>
      [] [] [] [] [(0, 0)]
        0 'pointsize' 20<br>
      [row_heights]<br>
      0 0 56.0<br>
      7 0 25.0<br>
      [col_widths]<br>
      0 0 80.0<br>
      [macros]<br>
      Macro text<br>
    </code>
</p>
<p class="one_line_heading">
    If the Python module xlwt is installed then pyspread can save
    the spreadsheet as Excel xls file.
    Cell attributes such as fonts and colors are preserved.
    Python expressions are exported as strings.
    Macros are not saved into the xls file.
</p>

<h4>Save As</h4>
<p class="one_line_heading">
    File -&gt; Save As saves the spreadsheet as does File -&gt; Save.
    While Save overwrites files that are opened on pyspread directly,
    Save As always always prompts for a file name.
</p>

<h4>Import</h4>
<p class="one_line_heading">
    With File -&gt; Import, a
    csv file can be imported. There are two import filters.
</p>
<p class="one_line_heading">
    "Tab-delimited text file" is
    fast but does not handle ill-formed data or special
    formats well. As the name suggests, only Tab delimited
    values are allowed.
</p>
<p class="one_line_heading">
    The other filter "Csv file"
    opens the CSV file import dialog. In this dialog, CSV
    import options can be set. Furthermore, target Python
    types can be specified, so that import of dates becomes
    possible. The grid of the import dialog only shows the
    first few rows of the csv files in order to give an
    impression how import data will look like in pyspread.
</p>
<p class="one_line_heading">
    Importing a file always
    activates safe mode (when no signature file is created
    manually) because code in the CSV file might prove
    harmful.
</p>
<p class="one_line_heading">
    <a href="images/screenshot_csv_import.png">
        <img alt="CSV file import dialog"
             src="images/screenshot_csv_import_preview.png"
             style="border: 0px solid ; width: 200px; height: 208px;">
    </a>
</p>

<h4>Export</h4>
<p class="one_line_heading">
    Pyspread can export spreadsheets to csv, pdf and svg files.
</p>

<h4>Approve file</h4>
<h4>Clear globals</h4>
<h4>Page setup</h4>
<h4>Print preview</h4>
<h4>Print</h4>
<h4>Preferences...</h4>

<p class="one_line_heading">
    The preferences dialog allows changing:
    <ul>
        <li>
            <b>Max. undo steps</b>:
            The maximum number of elementary steps
            that can be undone via Edit -&gt; Undo.
            Note that pressing one butoon may result in multiple
            elementary steps.
        </li>            
        <li>
            <b>Grid rows</b>:
            Initial number of grid rows when pyspread is started
            without paramaters.
        </li>
        <li>
            <b>Grid columns</b>:
            Initial number of grid columns when pyspread is started
            without paramaters.
        </li>
        <li>
            <b>Grid tables</b>:
            Initial number of grid tables when pyspread is started
            without paramaters.
        </li>
        <li>
            <b>Max. result length</b>:
            If a results is displayed as a string (and not as e.g. a
            bitmap) then the string is truncated to the value given
            here. The string length consideerd is the number of
            Unicode characters.
        </li>
        <li>
            <b>Timeout</b>:
            If calculations for a cell exceed the time in
            seconds given here  then calculation is aborted.
            This does not work
            for Python functions that are C code, so e.g.
            2**99999999999999999 is <i>not</i> aborted.
        </li>
        <li>
            <b>Timer interval</b>:
            If View -&gt; Toggle periodic updates is activated then
            all frozen cells are updated in an interval. This interval
            in milliseconds is set here. 
            The change takes effect the next time that View -&gt;   
            Toggle periodic updates is activated.
            Too small values may lock up pyspread.
        </li>
        <li>
            <b>GPG key id</b>:
            If a GPG key has been selected then its id is displayed
            here. Entering a new, valid id of an existing key that
            is <i>not</i> password protected changes the GPG key
            similarly to File -&gt; Switch GPG key... 
        </li>
    </ul>
</p>

<p class="one_line_heading">
    <a href="images/screenshot_preferences_dialog.png">
        <img alt="Preferences dialog"
             src="images/screenshot_preferences_dialog.png"
             style="border: 0px solid ; width: 200px; height: 208px;">
    </a>
</p>

<p class="one_line_heading">
    On *nix, Pyspread stores its configuration in a file
    ~/.pyspreadrc <br>
    This file is created when pyspread is started the first time.
    Removing it resets configuration.
</p>

<p class="one_line_heading">
    On Windows, them same information is stored in the registry.
</p>

<p class="one_line_heading">
    Initial configuration can be found in pyspread/src/config.py
</p>

<h4>Switch GPG key...</h4>
<h4>Quit</h4>

<p class="one_line_heading">
    File -&gt; Quit exits pyspread.
    If changes have been made to a new or loaded file then
    a dialog pops up and asks if the changes shall be saved.
</p>

<h3>Edit menu</h3>

<h4>Undo</h4>

<p class="one_line_heading">
    Most user actions in pyspread can be undone by Edit -&gt; Undo
    (Shortcut: &lt;Ctrl&gt; + Z). Exceptions are:
</p>

<ul class="one_line_heading">
  <li>
    Loading a file (empties undo list)
  </li>
  <li>
    Saving a file (ignored)
  </li>
  <li>
    Approving a file (ignored)
  </li>
  <li>
    Deleting global variables
  </li>
</ul>

<p class="one_line_heading">
    The undo list is limited.
    The limit can be set in the File -&gt; Preferences dialog.
</p>

<h4>Redo</h4>

    Undone steps can be redone with Edit -&gt; Redo
    (Shortcut: &lt;Shift&gt; + &lt;Ctrl&gt; + Z).

<h4>Cut</h4>

<p class="one_line_heading">
    Edit -&gt; Cut behaves like Edit -&gt; Copy and pressing the   
    &lt;Del&gt; key afterwards, i.e. the current cell code is
    copied and the cell is deleted.
    If cells are selected then the operations are applied to all
    cells in the bounding box of the marked cells.
</p>

<h4>Copy</h4>

<p class="one_line_heading">
    Edit -&gt; Copy copies cell code of the current cell (the one
    with the cursor) is copied.
    If cells are selected then the
    copied set consists of the bounding box of the marked
    cells, i. e. the smallest box, in which all cells are
    situated. Cells that are not selected in that box are
    copied as if they were empty. 
    The format of cells that are
    copied is tab separated Unicode.
</p>

<h4>Copy Results</h4>

<p class="one_line_heading">
    Edit -&gt; Copy Results copies a string representation of
    the current cell's result object.
    If e.g. the cell code of the current cell is 4*"a" then 
    aaaa is copied to the Clipboard.
    As in Edit -&gt; Copy,  if cells are selected then the
    copied set consists of the bounding box of the marked
    cells.
    Copy Results is useful, if for example results shall be copied
    into an external application.
</p>

<h4>Paste</h4>

<p class="one_line_heading">
    When pasting cells, these
    empty cells are pasted as well as the filled cells. That
    means that an unselected cell in a marked area will be
    pasted as empty cell.
</p>

<h4>Paste As</h4>

<p class="one_line_heading">
    Data can also be pasted with
    Paste As. The keyboard shortcut is &lt;Shift&gt; +
    &lt;Ctrl&gt; + V. A dialog appears, in which the target
    dimensionality can be specified. If the transpose box is checked 
    then the data is
    transposed. With this feature, fine grained access to
    which target data object dimensions are pasted into single
    cells and which are distributed across cells.
</p>

<p class="one_line_heading">
    <a href="images/screenshot_paste_as.png">
        <img alt="Paste As dialog" src="images/screenshot_paste_as.png"
             style="border: 0px solid; border: 0px solid; width: 200px;">
    </a>
</p>

<h4>Select All</h4>
<h4>Find</h4>
<p class="one_line_heading">
    Cell code and cell results
    can be searched with &lt;Ctrl&gt; + F or using the menu
    with Edit -&gt; Find. The focus changes to the search
    toolbar, in which search queries can be entered. Pyspread
    allows searching contained text, word-wise contained text
    and regular expressions, which can be toggled in the
    search toolbar. Similarly upper and lower case sensitivity
    can be toggled via the search toolbar.
</p>

<h4>Replace</h4>
<p class="one_line_heading">
    Replacing is done via the
    Find &amp; Replace dialog that is accessible via
    &lt;Shift&gt; + &lt;Ctrl&gt; + F or via Edit -&gt;
    Replace... Strings that are found are replaced with the
    replace string. Note that replace only allows searching in
    cell code and not in results.
</p>
<p class="one_line_heading">
    <a href="images/screenshot_replace.png"><img alt="Find &amp; Replace dialog"
       src="images/screenshot_replace_preview.png"
       style="border: 0px solid ; width: 200px; height: 81px;">
    </a>
</p>

<h4>Quote cell(s)</h4>
<h4>Sort ascending</h4>
<h4>Sort descending</h4>
<h4>Insert rows</h4>
<h4>Insert columns</h4>
<h4>Insert table</h4>
<h4>Delete rows</h4>
<h4>Delete columns</h4>
<h4>Delete table</h4>
<h4>Resize grid</h4>

<h3>View menu </h3>

<h4>Toolbars</h4>
<h4>Entry line</h4>
<h4>Go to cell</h4>
<h4>Zoom in</h4>
<h4>Zoom out</h4>
<h4>Normal size</h4>
<h4>Refresh selected cells</h4>
<h4>Toggle periodic updates</h4>
<h4>Show frozen</h4>

<h3>Format menu</h3>

<h4>Font...</h4>
<h4>Bold</h4>
<h4>Italics</h4>
<h4>Underline</h4>
<h4>Strikethrough</h4>
<h4>Frozen</h4>
<h4>Lock</h4>
<h4>Merge cells</h4>
<h4>Justification</h4>
<h4>Alignment</h4>
<h4>Text color...</h4>
<h4>Background color...</h4>
<h4>Rotation</h4>

<h3>Macro menu</h3>

<h4>Macro list</h4>
<h4>Load macro list</h4>
<h4>Save macro list</h4>
<h4>Insert bitmap...</h4>
<h4>Link bitmap...</h4>
<h4>Insert chart...</h4>

<h3>Help menu</h3>

<h4>First steps</h4>
<h4>Tutorial</h4>
<h4>FAQ</h4>
<h4>About</h4>

<h2>Context menu</h2>

<p class="one_line_heading">
    Besides the main menu, pyspread provides a context menu that
    is accessible by right-clicking on the grid. It contains the
    following items:
</p>

<ul class="one_line_heading">
    <li>Cut</li>
    <li>Copy</li>
    <li>Paste</li>
    <li>Insert rows</li>
    <li>Insert columns</li>
    <li>Delete rows</li>
    <li>Delete columns</li>
</ul>

<p class="one_line_heading">
    All options in the context menu are identical to those in the
    edit menu.
</p>


<h2>Toolbars</h2>

<h3>Main toolbar</h3>

<h3>Macro toolbar</h3>

<h3>Widget toolbar</h3>

<h3>Format toolbar</h3>

<h3>Find toolbar</h3>


<h2>Entry line</h2>


<h2>Insertion mode toggle button (enabled on *nix only)</h2>


<h2>Table selector</h2>

<p class="one_line_heading">
    Tables can be switched by
    changing the number in the table selector that is
    situated right of the entry line directly above the grid.
</p>

<p class="one_line_heading">
    This can be achieved by
    either typing in a table number or by moving the mouse
    over the table switch textbox and then scrolling with the
    mouse wheel.
</p>

<h2>Grid</h2>

<h3>Moving in the grid</h3>

<p class="one_line_heading">
    Row and column movement in the grid can be achieved by:
</p>

<ul class="one_line_heading">
  <li>
    Scrolling with the scrollbars
  </li>
  <li>
    Selecting View --&gt; Go to cell from the main menu
  </li>
  <li>
    Moving the grid cursor with the arrow keys
  </li>
  <li>
    Clicking on a cell
  </li>
  <li>
    Accessing the grid API (advanced)
  </li>
</ul>


<h2>Status bar</h2>
















<h1>Common spreadsheet tasks</h1>


<h2>Copy and Paste operations</h2>

<p class="one_line_heading">
    Copying and pasting can be done while in a cell editor (after 
    double-clicking on a cell). This copies the selected text.
</p>


<h2>Entering data</h2>

<p class="one_line_heading">
    Code is entered into the
    grid cells by selecting a cell and then typing.
    Code can also be entered into the entry line. Code
    is accepted and evaluated when &lt;Enter&gt; is
    pressed or when a new cell is selected.
</p>

<p class="one_line_heading">
    When data shall be displayed as text, it has to be quoted so
    that the code represents a Python string. In order to make
    such data entry easier, quotation is automatically added if
    &lt;Ctrl&gt;+&lt;Enter&gt; is pressed after editing a cell.
    If multiple cells are selected then
    &lt;Ctrl&gt;+&lt;Enter&gt; quotes all selected cell.
</p>

<p class="one_line_heading">
    When entering data in the entry line, pyspread &gt;=v0.3.0
    offers code completion and context help if the jedi package
    is installed. When &lt;Tab&gt; is pressed while typing, an
    unambiguous suggestion for the next characters is made.
    Furthermore, the entry line tooltip is changed so that it
    contains information about all found completions. The
    tooltip is truncated to 1000 characters.
</p>

<h2>Selecting cells</h2>

<p class="one_line_heading">
    Cells can be selected by the following actions:
</p>

<ul class="one_line_heading">
  <li>
      Keeping the left mouse button pressed while over cells selects a block
  </li>
  <li>
      Pressing &lt;Ctrl&gt;
      when left-clicking on cells selects these cells
      individually
  </li>
  <li>
      Clicking on row or
      column labels selects all cells of a row or column
  </li>
  <li>
      Clicking on the top-left
      label of the grid or pressing &lt;Ctrl&gt; + A selects
      all grid cells of the current table
  </li>
</ul>

<p class="one_line_heading">
    Only cells of the current
    table can be selected at any time. Switching tables
    switches cell selections to the new table, i.e. the same
    cells in the new table are selected and no cells of the
    old table are selected.
</p>

<h2>Changing and deleting cell content</h2>

<p class="one_line_heading">
    In order to change cell
    content, double-click on the cell or select the cell and
    edit the text in the entry line.
</p>

<p class="one_line_heading">
    A cell can be deleted by
    selecting it and pressing &lt;Del&gt;. This also works for
    selections.
</p>



<h2>Creating an empty spreadsheet</h2>

<p class="one_line_heading">
    An empty spreadsheet can be created by File -&gt; New. <br>
    A Dialog pops up, in which
    the size of the new spreadsheet grid can be entered. Note
    that even though sizes of several million rows or columns
    are possible, there is a limit that is imposed by
    wx.Python. Therefore, grids with more than 80 million rows
    and 30 million columns may show problems and
    instabilities.
</p>
<p class="one_line_heading">
    <a href="images/screenshot_new_dialog.png">
        <img alt="Grid dimension dialog"
             src="images/screenshot_new_dialog_preview.png"
             style="border: 0px solid; border: 0px solid; width:
             200px; height: 141px;">
    </a>
</p>

<h2>Loading and saving a spreadsheet</h2>

<p class="one_line_heading">
    Loading and saving a
    spreadsheet from and to disk can be initiated with File
    -&gt; Open and<br>
    File -&gt; Save. Opening a file expects a file with the
    extension .pys. The file format is pyspread specific.<br>
</p>
<p class="one_line_heading">
    Starting from v0.3.0 there
    is a second file format with the extension .pysu. It is
    identical to pys but for the file being uncompressed. This
    format can be beneficial when using pyspread in
    combination with file version control systems such as git.<br>
</p>
<p class="one_line_heading">
    Since pyspread files are
    ultimately Python programs, an opened file is stored in
    safe mode if it has not been previously signed by the
    current user on the current system. Safe mode means that
    the cell content is loaded and displayed in the grid.
    However, it is not executed, so that 2+2 remains 2+2 and
    is not computed into 4. You can leave safe mode with File
    -&gt; Approve.
</p>
<p class="one_line_heading">
    When a file is saved, a
    signature is created in an additional file with the suffix
    .pys.sig. The signature is a PGP signature. When pyspread
    is started the first time for a user, a pgp key pair is
    crreated for the user pyspread_&lt;user-id&gt;. This key
    pair is used for signing pyspread save files. A correct
    signature file lets pyspread open a file without going
    into safe mode. Note that the save file is <span
    style="font-weight: bold;">not</span> encrypted in any
    way.
</p>
<p class="one_line_heading">
    The pys file format is a
    bzip2-ed Text file with the following structure (since
    version 0.2.0):
</p>

<p class="one_line_heading">
    <code>
      [Pyspread save file version]<br>
      0.1<br>
      [shape]<br>
      1000 100 3<br>
      [grid]<br>
      7 22 0 'Testcode1'<br>
      8 9 0 'Testcode2'<br>
      [attributes]<br>
      [] [] [] [] [(0, 0)]
        0 'textfont' u'URW Chancery L'<br>
      [] [] [] [] [(0, 0)]
        0 'pointsize' 20<br>
      [row_heights]<br>
      0 0 56.0<br>
      7 0 25.0<br>
      [col_widths]<br>
      0 0 80.0<br>
      [macros]<br>
      Macro text<br>
    </code>
</p>

<h2>CSV data import and export</h2>

<p class="one_line_heading">
    Pyspread can import and
    export csv data for interacting with other applications.
    However, grid formatting is lost this way.
</p>
<p class="one_line_heading">
    With File -&gt; Import, a
    csv file can be imported. There are two import filters.
</p>
<p class="one_line_heading">
    "Tab-delimited text file" is
    fast but does not handle ill-formed data or special
    formats well. As the name suggests, only Tab delimited
    values are allowed.
</p>
<p class="one_line_heading">
    The other filter "Csv file"
    opens the CSV file import dialog. In this dialog, CSV
    import options can be set. Furthermore, target Python
    types can be specified, so that import of dates becomes
    possible. The grid of the import dialog only shows the
    first few rows of the csv files in order to give an
    impression how import data will look like in pyspread.
</p>
<p class="one_line_heading">
    Importing a file always
    activates safe mode (when no signature file is created
    manually) because code in the CSV file might prove
    harmful.
</p>


<h2>XLS data import and export</h2>

<p class="one_line_heading">
    Starting with version 0.2.6, pyspread can load Excel xls
    files. Starting with version 0.3.0, pyspread can save Excel
    xls files. However, xls file support does not work without
    losses in cell formatting. Excel formulas are currently not
    interpreted.
</p>


<h2>Printing</h2>
<p class="one_line_heading">
    When selecting File -&gt;
    Print, the grid is printed.
</p>


<h2>Finding and replacing</h2>
<p class="one_line_heading">
    Cell code and cell results
    can be searched with &lt;Ctrl&gt; + F or using the menu
    with Edit -&gt; Find. The focus changes to the search
    toolbar, in which search queries can be entered. Pyspread
    allows searching contained text, word-wise contained text
    and regular expressions, which can be toggled in the
    search toolbar. Similarly upper and lower case sensitivity
    can be toggled via the search toolbar.
</p>
<p class="one_line_heading">
    Replacing is done via the
    Find &amp; Replace dialog that is accessible via
    &lt;Shift&gt; + &lt;Ctrl&gt; + F or via Edit -&gt;
    Replace... Strings that are found are replaced with the
    replace string. Note that replace only allows searching in
    cell code and not in results.
</p>

<p class="one_line_heading">
    <a href="images/screenshot_replace.png"><img alt="Find &amp; Replace dialog"
       src="images/screenshot_replace_preview.png"
       style="border: 0px solid ; width: 200px; height: 81px;">
    </a>
</p>

<h2>Sorting</h2>

<p class="one_line_heading">
    Pyspread provides sorting
    buttons for ascending and descending sorts.
</p>


<h1>Working with formulas</h1>

<h2>Grid cells expect Python expressions</h2>

<p class="one_line_heading">
    Python expressions are terms
    that Python evaluates to a result object. 
    <a href="http://docs.python.org/reference/expressions.html">
        http://docs.python.org/reference/expressions.html
    </a>
    gives an overview to the different types of Python
    expressions.
</p>

<p class="one_line_heading">
    Pyspread expects such Python
    expressions in its grid cells. Therefore<br>
    <code>1 + 1</code>
</p>
<p class="one_line_heading">
    is valid as is<br>
    <code>[i ** 2 for i in xrange(100) if i % 3]</code>
</p>
<p class="one_line_heading">
    However, statements such as<br>
    <code>print 2</code>
</p>
<p class="one_line_heading">
    or<br>
    <code>import math</code>
</p>
<p class="one_line_heading">
    are <strong>not</strong> valid.
</p>
<p class="one_line_heading">
    Note: Use <code>math = __import__("math")</code>
    instead of the latter example.
</p>

<h2>Variable assignment</h2>

<p class="one_line_heading">
    Besides Python expressions,
    one variable assignment is accepted within a cell. The
    assignment consists of one variable name at the start
    followed by "=" and a Python expression. The variable is
    considered as global. Therefore, it is accessible from
    other cells.
</p>
<p class="one_line_heading">
    For example<br>
    <code>a = 5 + 3</code>
</p>
<p class="one_line_heading">
    assigns 8 to the global
    variable a.
</p>
<p class="one_line_heading">
    Since only one assignment is
    possible,<br>
    <code>b = c = 4</code>
</p>
<p class="one_line_heading">
    is <strong style="font-weight: bold;">not</strong> valid in a
    pyspread cell.
</p>
<p class="one_line_heading">
    Evaluation order
    of cells is not guaranteed. Therefore, assigning a
    variable twice may result in unpredictable behavior of the
    spreadsheet.
</p>

<h2>Result strings in the grid</h2>

<p class="one_line_heading">
    Cells that contain a Python
    expression display the string representation of the result
    object that is returned from this expression.
</p>
<p class="one_line_heading">
    Exceptions to this rule are:
</p>
<ul class="one_line_heading">
    <li>
        The None object that displays an empty string i. e. an
        empty cell instead. All empty cells also return None so
        that an empty grid appears empty.
    </li>
    <li>
        wx.Bitmap objects that are displayed as images
    </li>
    <li>
        matplotlib figure objects that are displayed as images
    </li>
    <li>
        Valid SVG figure strings.
    </li>
</ul>

<h2>Absolute cell access</h2>

<p class="one_line_heading">
    The result objects, for
    which string representations are displayed in the grid,
    can be accessed from other cells (and from macros as well)
    via the __getitem__ method of the grid, where the grid
    object is globally accessible via the name S. For example<br>
    <code>S[3, 2, 1]</code><br>
    returns the result object
    from the cell in row 3, column 2, table 1. This type of
    access is called absolute because the targeted cell does
    not change when the code is copied to another cell similar
    to a call $A$1 in a common spreadsheet.
</p>

<p class="one_line_heading">
    In order to make referencing cells easier, a toggle button
    can be pressed when editing a cell. When it is toggled on, a
    selection is converted into its code representation at the
    cursor. Note that selection a cell is not enough. It has to
    be selected (blue background) so that you see the selection
    representing code.
</p>

<h2>Relative cell access</h2>
<p class="one_line_heading">
    In order to access a cell
    relative to the current cell position, 3 variables X, Y
    and Z are provided that point to the row, the column and
    the table of the calling cell. The values stay the same
    for called cells. Therefore,<br>
    <code>S[X-1, Y+1, Z]</code><br>
    returns the result object of
    the cell that is in the same table two rows above and 1
    column right of the current cell. This type of access is
    called relative because the targeted cell changes when the
    code is copied to another cell similar to a call A1 in a
    common spreadsheet.
</p>

<h2>Slicing the grid</h2>

<p class="one_line_heading">
    Cell access can refer to
    multiple cells by slicing similar to slicing a matrix in
    numpy. Therefore, a slice object is used in the
    __getitem__ call. For example<br>
    <code>S[:3, 0, 0]</code><br>
    returns the first three rows
    of column 0 in table 0 and<br>
    <code>S[1:4:2, :2, -1]</code><br>
    returns row 1 and 3 and
    column 0 and 1 of the last table of the grid.
</p>
<p class="one_line_heading">
    The returned object is a
    numpy object array of the result objects. This object
    allows utilization of the numpy commands such as numpy.sum
    that address all array dimensions instead of only the
    outermost. For example<br>
    <code>numpy.sum(S[1:10, 2:4, 0])</code><br>
    sums up the results of all
    cells from 1, 2, 0 to 9, 3, 0 instead of summing each row,
    which Pythons sum function does.
</p>
<p class="one_line_heading">
    One disadvantage of this
    approach is that slicing results are not sparse as the
    grid itself and therefore consume memory for each cell.
    Therefore,<br>
    <code>S[:, :, :]</code><br>
    will lock up or even crash
    pyspread with a memory error if the grid size is too
    large.
</p>

<h2>Frozen cells</h2>

<p class="one_line_heading">
    In order to prevent cells
    from being evaluated, cells can be marked as frozen
    (flurry button on attribute toolbar). When this is done,
    the current cell code is evaluated and the result is
    stored in a cache. Instead of re-evaluating each time that
    another cell is updated, frozen cells always display the
    old, stored result.
</p>
<p class="one_line_heading">
    The flurry button can only
    mark one cell at a time as frozen. The selection is
    ignored for this purpose. Only the cell at the cursor is
    frozen.
</p>
<p class="one_line_heading">
    Frozen cells can be
    refreshed using the menu with View -&gt; Refresh Selected
    Cells or with &lt;F5&gt;. All selected cells are refreshed
    by this command.
</p>
<p class="one_line_heading">
    Frozen cells can speed up
    spreadsheets with long running calculations. Furthermore,
    the number of callings of stateful functions can be
    controlled.
</p>
<p class="one_line_heading">
    While the frozen
    attribute is stored in the pys save-file, the frozen cell
    result cache is <strong>not</strong>.
</p>

<h2>Locked cells</h2>

<p class="one_line_heading">
    Locked cells cannot be edited. You can lock and unlock cells
    by clicking on the lock symbol on the attributes toolbar.
</p>

<h2>Macros</h2>

<p class="one_line_heading">
    Since cell evaluation order
    is not guaranteed in pyspread, macros can be used for
    operations that enforce state. One example for such
    operations are some module imports such as rpy2.
    Furthermore, algorithms that are too complex for a single
    cell can be written as a macro.
</p>
<p class="one_line_heading">
    Macros can be edited from
    within the macro editor via Macro -&gt; Macro list
    (Figure). The editor allows editing a text file that is
    executed when the spreadsheet is opened or when its
    content is updated.
</p>
<p class="one_line_heading">
    The scope of macro execution
    is global. Therefore, all functions are directly
    accessible from each cell. For example, the function f
    that is displayed in the Figure can be called from a cell
    via f(). The result is the returned string "Hello World".

    <a href="images/screenshot_macros.png">
        <img alt="Macro editor" src="images/screenshot_macros_preview.png"
             style="border: 0px solid ; width: 200px; height: 156px;">
    </a>
</p>

<h2>Module import</h2>
<p class="one_line_heading">
    Python modules cannot be
    imported with the import statement from within a cell
    because this statement is no Python expression. Therefore,
    module import from within a cell has to be realized by
    calling the function __import__:<br>
    <code>&lt;module_name&gt; = __import__("&lt;module name&gt;")</code><br>
    This cell makes the module
    available from each other cell. Alternatively, a module
    can be imported as a macro with the import statement.
</p>
<p class="one_line_heading">
    There are modules, which
    cannot be imported from within a cell. One example is rpy2
    (rpy works well). The reason is that module initialization
    is stateful, i. e. certain statements have to be called in
    a specific order. Such modules can be used after
    initializing them with the macro editor.
</p>

<h2>Cyclic references</h2>
<p class="one_line_heading">
    Cyclic references are
    possible again in version 0.2.0. However, recursion depth
    is limited. Pyspread shows an error when the maximum
    recursion is exceeded. Cyclic references are required for
    algorithms, in which cell objects are altered dynamically
    when cells are called. The drawback of allowing cyclic
    references is that complex cyclic calculations can lead to
    locking up pyspread.
</p>

<h2>Result stability</h2>
<p class="one_line_heading">
    Result stability when
    redefining global variables cannot be guaranteed because
    execution order may be changed. This happens for when in
    large spreadsheets the result cache is full and cell
    results that are purged from the cache are re-evaluated.
</p>

<h2>Error handling</h2>
<p class="one_line_heading">
    Cells that contain
    expressions that raise an exception return the error
    string.
</p>


<h1>Using help</h1>

<h2>Access to this document</h2>
<p class="one_line_heading">
    This document can be
    displayed from within pyspread via the menu with Help
    -&gt; First Steps.
</p>

<h2> Python tutorial</h2>
<p class="one_line_heading">
    With Help -&gt; Python
    tutorial, the Python tutorial is shown via the Internet.
    Note that a working Internet connection is required to
    access the Python tutorial.
</p>


<h1>Grid layout</h1>

<h2>Formatting cell output</h2>
<p class="one_line_heading">
Grid formatting changes cell
attributes for all cells in a selection. All formatting is
considered to be done consecutively.
</p>

<h2>Fonts and font attributes</h2>
<p class="one_line_heading">
    Fonts can be assigned by
    selection cells and choosing a font from the format menu
    and the attribute toolbar. Fonts are <strong
    style="font-weight: bold;">not</strong> stored within
    the pys file. Therefore, fonts have to be available at the
    target system. Otherwise, the font is replaced by the
    default font.
</p>

<h2>Text alignment, justification and rotation</h2>

<p class="one_line_heading">
    Text alignment,
    justification and rotation of a selection of cells can be
    changed from the format menu and from the attributes
    toolbar. For alignment and justification, a toggle button
    is used i. e. when pressing the button, the next setting
    is applied. In order to get back to the original state,
    the button has to be pressed three times in both cases.
</p>

<h2>Border and background color</h2>

<p class="one_line_heading">
    Border and background color
    of a selection of cells can be changed from the format
    menu and attributes toolbar. Colors are always considered
    solid.
</p>
<p class="one_line_heading">
    Color is allied to borders
    dependent on the settings of the border drop box in the
    attribute toolbar. In order to get only outer borders of
    your selection a different color choose the corresponding
    border setting.
</p>

<h2>Border width</h2>

<p class="one_line_heading">
    Border width of a selection
    of cells can be changed from the attributes menu.
</p>
<p class="one_line_heading">
    Border width is allied to
    borders dependent on the settings of the border choice box
    in the attribute toolbar. In order to get only outer
    borders of your selection a different color choose the
    corresponding border setting.
</p>

<h2>Row height and column width</h2>

<p class="one_line_heading">
    Row heights and column
    widths can be altered by dragging the borders with the
    mouse. Non-default widths and heights are stored in the
    pys file.
</p>

<h2>Insertion and deletion of rows, columns and tables</h2>

<p class="one_line_heading">
    Insertion and deletion
    commands from the main menu and the context menu insert or
    delete one row, column or table if no selections are made.
</p>
<p class="one_line_heading">
    Multiple rows and columns
    (but not tables) can be inserted or deleted by selecting
    cells from the respective number of columns or rows.
    However, insertion always takes place at the cursor and <strong>not</strong>
    at the selections.
</p>


<h1>pyspread and security</h1>

<h2>More than your average spreadsheet</h2>

<p class="one_line_heading">
    Pyspread cells contain
    Python code. Instead of a special purpose language, you
    enter code in a general purpose language. This code can do
    everything that the operating system allows. Normally,
    this is a lot.
</p>
<p class="one_line_heading">
    Even though the situation
    differs little to common spreadsheet applications, the
    approach makes malicious attacks easy. Instead of knowing
    how to circumvent blocks of the domain specific language
    to make the computer do what you want, everything is
    straight forward.
</p>
<p class="one_line_heading">
    In order to make working
    with pyspread as safe as possible, all save-files (pys
    files and pysu files) are signed by the current user with
    a gpg signature file. Only a user with a private key can
    open the file without approving it. That should ensure
    that when loading a pys file, only the code that a user
    has written him- or herself is executed. Pys files without
    a valid signatures are opened in safe mode, i. e. the code
    is displayed and not executed. However, it can be approved
    after inspection.
</p>
<p class="one_line_heading">
    Please note that in version
    0.2.3 or higher, keys with passwords are no longer
    supported. Since gpg should only make sure that the file
    that you are trying to open is your own file,
    password-less key pairs should provide sufficient
    security.
</p>
<p class="one_line_heading">
    Therefore, never approve
    foreign pys-files unless you have <strong>checked
    thoroughly each cell</strong>. One cell may delete you
    hard drive. And it is likely to be found somewhere in the
    middle of a million rows, a million tables and a million
    tabs. If unsure, inspect the pys-file. It is a bzip2-ed
    text file. You can read it. You can grep in it.
</p>
<p class="one_line_heading">
    It may also be a good idea
    to run pyspread with a special user that has restricted
    privileges.
</p>
<p class="one_line_heading">
    If you like it even safer
    then use a sandbox. Chroot may be a good idea. Qemu / kvm
    are also worth a thought.
</p>

<h2>Security risks and annoyances from the save file signatures</h2>

<p class="one_line_heading">
    The security concept has
    risks apart from unintentionally approving malicious
    files.
</p>
<p class="one_line_heading">
    In order to share files,
    private keys might be exchanged by users. This would brake
    the security concept because exchanged private keys may
    spread.
</p>
<p class="one_line_heading">
    The signature concept would fail if gpg signatures were broken.
</p>
<p class="one_line_heading">
    If a pys file is situated in
    a folder without write and file creation access, the
    signature file cannot be created. Therefore, the file has
    to approved each time, which may lead to blind
    "o.&nbsp;k." clicking behavior.
</p>


<h1>Charts</h1>


<p class="one_line_heading">
    Since version 0.2.3, pyspread can generate <a
    href="http://matplotlib.org/">matplotlib</a> charts.
    Each cell, which yields a matplotlib figure displays this
    figure. The bitmap is stretched to the cell's extents.
</p>
<p class="one_line_heading">
    The "Insert chart" option in
    the Macros menu provides an easy way of generating
    matplotlib figures. They generate code of a special class
    charts.ChartFigure that is provided by pyspread. This
    class subclasses the matplotlib Figure class. The subclass
    takes matplotlib arguments and creates a figure in one
    step. The dialog creates the code for doing that. It also
    parses any code starting with charts.ChartFigure and
    figures out, which choice had been made last time. This
    may very well fail if you changed the cell code manually.
</p>
<p class="one_line_heading">
    In version 0.4, six chart
    types are supported: Plots, i.e. line charts, bar charts,
    histograms, box plots, pie charts and annotations. Note
    that pie charts cannot be combined with other chart type
    yet. Please suggest other chart types that you find usable
    by posting at <a href="mailto:pyspread-users@gna.org">pyspread-users@gna.org</a>.
</p>
<p class="one_line_heading">
    Matplotlib figures can also
    be used to display LaTeX equations. However, pyspread has
    not yet an interface dialog for equations. A macro that
    depicts LaTeX equations in a cell is provided in the
    examples directory.
</p>


<h1>Images</h1>


<p class="one_line_heading">
    Since version 0.2.3, images can be displayed in cells.
    Each cell, which yields a wx.Bitmap object, displays the bitmap.
    For each cell that yields a valid SVG xml string, the SVG ist displayed.
</p>

<p class="one_line_heading">
    Images can be inserted via
    copy and paste. This creates cell code, which contains a
    serialized string that represents the bitmap. The code can
    be of considerable size. Therefore, it is normally split
    into multiple lines. Line breaks inside a cell are ignored
    by pyspread. Therefore, each cell behaves like one line of
    Python code even if multiple lines are displayed in the
    cell editor.
</p>
<p class="one_line_heading">
    The "Insert bitmap" option
    in the Macros menu is Identical to the copy and paste
    functionality.
</p>
<p class="one_line_heading">
    Lining an image with the
    "Link bitmap" option in the Macros menu generates code
    that refers to an image on the file system. This method
    allows displaying high resolution images in a pyspread
    grid. Please not that the image path is currently
    absolute. You can replace it manually with a relative
    path.
</p>


<h1>Advanced topics</h1>


<h2>Drawing cell content with a cell formula</h2>
<p class="one_line_heading">
    Drawing with cell formulas is deprecated and supported only
    for compatibility reasons. Please do not use it in your
    spreadsheets.
</pr>

<h2>Handling large amounts of data</h2>
<p class="one_line_heading">
    While the pyspread main grid
    may be large, filling many cells may consume considerable
    amounts of memory. When handling large amounts of data,
    data that is loaded within one cell saves memory,
    Therefore, load all your data in a numpy array that is
    situated within a cell and work from there.
</p>

<h2>Substituting pivot tables</h2>
<p class="one_line_heading">
    In the examples directory, a Pivot table replacement is
    shown using list comprehensions.
</p>

<h2>Images in version 0.2.3</h2>
<p class="one_line_heading">
    In pyspread version 0.2.3, any image is shrunk until it
    fits into the 64k character limit of a cell. Starting from
    version 0.2.4, this limit is removed and no shrinking is
    done.
</p>
<p class="one_line_heading">
    In order to display high quality images in version 0.2.3,
    the Insert linked image command in the Macro menu and the
    Macro toolbar can be used. Note that it creates an absolute
    link to the image.
</p>


<p class="impressum">
  Author:
  <a href="mailto:mmanns <at> gmx <dot> net">
    Martin Manns (mmanns &lt; at &gt; gmx &lt; dot &gt; net)
  </a>
  <br> <br>
  Last changed: 20. January  2014</span>
</p>